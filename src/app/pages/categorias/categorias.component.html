<div class="container">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <app-menu></app-menu>

    <!-- Abas -->
    <div class="abas">
      <button [class.ativa]="abaSelecionada === 'receitas'" (click)="abaSelecionada = 'receitas'">Receitas</button>
      <button [class.ativa]="abaSelecionada === 'despesas'" (click)="abaSelecionada = 'despesas'">Despesas</button>
      <button [class.ativa]="abaSelecionada === 'contas'" (click)="abaSelecionada = 'contas'">Contas</button>
    </div>
    <div class="linha-aba"></div>

    <!-- Conteúdo das Categorias -->
    <div class="conteudo" *ngIf="abaSelecionada === 'receitas'">
      <div class="painel-categorias">

        <!-- CATEGORIAS -->
        <div class="tabela">
          <div class="cabecalho-titulo">
            
            <div>
              <i class="bi bi-plus-circle" (click)="abrirPopupCategoria()"></i>
            </div>
          </div>

          <div class="cabecalho">
            <div>Descrição</div>
            <div>Total</div>
            <div>Ações</div>
          </div>

          <div class="linha" *ngFor="let categoria of categoriasReceitas">
            <div>⭐ {{ categoria.descricao }}</div>
            <div>{{ categoria.total.toFixed(2).replace('.', ',') }}</div>
            <div class="menu-acao-wrapper">
              <i class="bi bi-three-dots icone-acao" (click)="toggleMenu(categoria)"></i>

              <div class="menu-popup" *ngIf="categoria.menuAberto">
                <div class="opcao" (click)="editarCategoria(categoria)">Editar</div>
                <div class="opcao" (click)="excluirCategoria(categoria)">Excluir</div>
                <div class="opcao" (click)="verGrafico(categoria)">Gráfico evolução mensal</div>
              </div>
            </div>
          </div>

          <div class="rodape">
            <div>Categorias: <b>{{ categoriasReceitas.length }}</b></div>
            <div>Total: <b>R$ {{ calcularTotalReceitas().toFixed(2).replace('.', ',') }}</b></div>
          </div>
        </div>

        <!-- SUBCATEGORIAS -->
        <div class="tabela">
          <div class="cabecalho-titulo">
            <div><b>Subcategorias de Trabalhos extras</b></div>
            <div>
              <i class="bi bi-plus-circle" (click)="toggleOptions()"></i>
            </div>
          </div>

          <div class="subcabecalho">
            <div>Descrição</div>
            <div>Total</div>
            <div>Ações</div>
          </div>

          <div class="linha" *ngFor="let sub of subcategoriasTrabalhoExtra">
            <div>⭐ {{ sub.descricao }}</div>
            <div>{{ sub.total.toFixed(2).replace('.', ',') }}</div>
            <div class="menu-acao-wrapper">
              <i class="bi bi-three-dots icone-acao" (click)="toggleMenuSub(sub)"></i>

              <div class="menu-popup" *ngIf="sub.menuAberto">
                <div class="opcao" (click)="editarSubcategoria(sub)">Editar</div>
                <div class="opcao" (click)="excluirSubcategoria(sub)">Excluir</div>
                <div class="opcao" (click)="verGraficoSub(sub)">Gráfico evolução mensal</div>
              </div>
            </div>
          </div>

          <div class="rodape">
            <div>Subcategorias: <b>{{ subcategoriasTrabalhoExtra.length }}</b></div>
            <div>Total: <b>R$ {{ calcularTotalSubcategorias().toFixed(2).replace('.', ',') }}</b></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- POPUP NOVA CATEGORIA -->
  <div class="popup-backdrop" *ngIf="mostrarPopupCategoria">
    <div class="popup">
      <div class="popup-topo">
        <span><b>Nova categoria</b></span>
        <button class="btn-salvar">Salvar</button>
        <button class="btn-fechar" (click)="fecharPopupCategoria()">×</button>
      </div>

      <div class="popup-conteudo">
        <label>Nome</label>
        <input type="text" />

        <label>Ícone</label>
        <div class="icone-selector">
          <i class="bi" [ngClass]="iconeSelecionado" (click)="mostrarOpcoesIcone = !mostrarOpcoesIcone"></i>
          <div class="icones-opcoes" *ngIf="mostrarOpcoesIcone">
            <i *ngFor="let icone of iconesDisponiveis" class="bi" [ngClass]="icone" (click)="selecionarIcone(icone)"></i>
          </div>
        </div>

        <label>Cor</label>
        <div class="cor-selector">
          <span class="cor-bolinha" [ngStyle]="{'background-color': corSelecionada}" (click)="trocarCor()"></span>
        </div>

        <label>Informação Adicional</label>
        <textarea></textarea>
      </div>
    </div>
  </div>
</div>  